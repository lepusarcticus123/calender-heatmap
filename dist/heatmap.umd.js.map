{"version":3,"file":"heatmap.umd.js","sources":["../index.js"],"sourcesContent":["class Heatmap {\r\n  constructor(container, data, options) {\r\n    this.container = container;\r\n    this.data = data;\r\n    this.options = options;\r\n    const defaultOptions = {\r\n      x: 20,\r\n      y: 10,\r\n      color: \"green\",\r\n      cellSpacing: 2,\r\n      tipMonth: {\r\n        value: true,\r\n        format: (month) => month + \"月\", // 默认直接返回月份\r\n      },\r\n      tooltip: {\r\n        value: true,\r\n        format: (value) =>\r\n          `${value[1].toFixed(2)} 于 ${value[0].split('-')[0]}年 ${\r\n            value[0].split('-')[1]\r\n          }月 ${value[0].split('-')[2]}日`, // 默认显示值和日期\r\n      },\r\n    };\r\n    // 合并默认选项和用户传入的选项\r\n    this.options = { ...defaultOptions, ...options };\r\n  }\r\n  getColor(value, color) {\r\n    switch (color) {\r\n      case \"green\":\r\n        const green = [\r\n          { threshold: 0, color: \"#ebedf0\" }, // 最浅灰绿\r\n          { threshold: 1, color: \"#d4f5d0\" }, // 浅灰绿\r\n          { threshold: 10, color: \"#9be9a8\" }, // 浅绿色\r\n          { threshold: 15, color: \"#6dd785\" }, // 中浅绿色\r\n          { threshold: 20, color: \"#40c463\" }, // 中绿色\r\n          { threshold: 25, color: \"#30a14e\" }, // 深绿色\r\n          { threshold: 35, color: \"#216e39\" }, // 深灰绿色\r\n          { threshold: 50, color: \"#154823\" }, // 最深绿色\r\n        ];\r\n        for (let i = green.length - 1; i >= 0; i--) {\r\n          if (value >= green[i].threshold) return green[i].color;\r\n        }\r\n      case \"purple\":\r\n        const purple = [\r\n          { threshold: 0, color: \"#f5eef8\" }, // 最浅灰紫\r\n          { threshold: 1, color: \"#ebd7f1\" }, // 浅灰紫\r\n          { threshold: 10, color: \"#d7bde2\" }, // 浅紫色\r\n          { threshold: 15, color: \"#b887cd\" }, // 中浅紫\r\n          { threshold: 20, color: \"#a569bd\" }, // 中紫色\r\n          { threshold: 25, color: \"#8e44ad\" }, // 深紫色\r\n          { threshold: 35, color: \"#6b3582\" }, // 深灰紫\r\n          { threshold: 50, color: \"#5b2c6f\" }, // 最深紫色\r\n        ];\r\n        for (let i = purple.length - 1; i >= 0; i--) {\r\n          if (value >= purple[i].threshold) return purple[i].color;\r\n        }\r\n      case \"blue\":\r\n        const blue = [\r\n          { threshold: 0, color: \"#ebedf0\" }, // 最浅灰蓝\r\n          { threshold: 1, color: \"#d0e7f9\" }, // 浅灰蓝\r\n          { threshold: 10, color: \"#c6e0f5\" }, // 浅蓝色\r\n          { threshold: 15, color: \"#9bccf2\" }, // 中浅蓝\r\n          { threshold: 20, color: \"#73b3e7\" }, // 中蓝色\r\n          { threshold: 25, color: \"#3b82f6\" }, // 深蓝色\r\n          { threshold: 35, color: \"#215bb7\" }, // 深灰蓝\r\n          { threshold: 50, color: \"#174ea6\" }, // 最深蓝色\r\n        ];\r\n        for (let i = blue.length - 1; i >= 0; i--) {\r\n          if (value >= blue[i].threshold) return blue[i].color;\r\n        }\r\n      case \"orange\":\r\n        const orange = [\r\n          { threshold: 0, color: \"#fef5e7\" }, // 最浅灰橙\r\n          { threshold: 1, color: \"#fdebd0\" }, // 浅灰橙\r\n          { threshold: 10, color: \"#fdd0a6\" }, // 浅橙色\r\n          { threshold: 15, color: \"#f5b041\" }, // 中浅橙\r\n          { threshold: 20, color: \"#f39c12\" }, // 中橙色\r\n          { threshold: 25, color: \"#dc7633\" }, // 深橙色\r\n          { threshold: 35, color: \"#b24d00\" }, // 深灰橙\r\n          { threshold: 50, color: \"#a04000\" }, // 最深橙色\r\n        ];\r\n        for (let i = orange.length - 1; i >= 0; i--) {\r\n          if (value >= orange[i].threshold) return orange[i].color;\r\n        }\r\n      default:\r\n        return `rgb(${value * 255}, ${value * 255}, ${value * 255})`;\r\n    }\r\n  }\r\n\r\n  paint() {\r\n    const tooltip = document.createElement(\"div\"); // 创建一个 div 元素\r\n    tooltip.setAttribute(\"id\", \"tooltip\"); // 设置该 div 的 id 属性为 \"tooltip\"\r\n    const parentElement = this.container.parentElement;\r\n    tooltip.style.position = \"absolute\";\r\n    tooltip.style.backgroundColor = \"rgba(0, 0, 0, 0.9)\";\r\n    tooltip.style.color = \"white\";\r\n    tooltip.style.padding = \"6px\";\r\n    tooltip.style.borderRadius = \"5px\";\r\n    tooltip.style.opacity = \"0\";\r\n    tooltip.style.fontSize = \"smaller\";\r\n    tooltip.style.transition = \"opacity 0.5s\";\r\n    tooltip.style.pointerEvents = \"none\"; // 防止鼠标事件干扰\r\n    parentElement.appendChild(tooltip);\r\n\r\n    const scale = this.container.width.baseVal.value;\r\n    const scaleY = this.container.height.baseVal.value;\r\n    this.container.style.height = scaleY + 20;\r\n    const rx = scale * 0.01; // SVG 宽度的 2%\r\n    const ry = scaleY * 0.01; // SVG 高度的 2%\r\n\r\n    this.data.forEach((value, index) => {\r\n      let rect = document.createElementNS(\"http://www.w3.org/2000/svg\", \"rect\");\r\n      rect.setAttribute(\r\n        \"x\",\r\n        Math.floor(index / this.options.y) * (scale / this.options.x) // 列号\r\n      );\r\n      rect.setAttribute(\r\n        \"y\",\r\n        (index % this.options.y) * (scaleY / this.options.y) // 行号\r\n      );\r\n\r\n      rect.setAttribute(\r\n        \"width\",\r\n        scale / this.options.x - this.options.cellSpacing\r\n      );\r\n      rect.setAttribute(\r\n        \"height\",\r\n        scaleY / this.options.y - this.options.cellSpacing\r\n      );\r\n      rect.setAttribute(\"fill\", this.getColor(value[1], this.options.color));\r\n      rect.setAttribute(\"rx\", rx); // 设置圆角x轴半径\r\n      rect.setAttribute(\"ry\", ry); // 设置圆角y轴半径\r\n      this.container.appendChild(rect);\r\n      //月份提示\r\n      if (this.options.tipMonth.value) {\r\n        const day = value[0].split(\"-\")[2];\r\n        const month = value[0].split(\"-\")[1];\r\n        if (day == \"01\") {\r\n          const text = document.createElementNS(\r\n            \"http://www.w3.org/2000/svg\",\r\n            \"text\"\r\n          );\r\n          text.textContent = this.options.tipMonth.format(parseInt(month, 10)); // 格式化月份\r\n\r\n          const textX =\r\n            Math.floor(index / this.options.y) * (scale / this.options.x) + 10;\r\n          let textY = scaleY + 17; // 计算文本的 Y 坐标\r\n          text.setAttribute(\"x\", textX);\r\n          text.setAttribute(\"y\", textY); // 设置文本的 Y 坐标\r\n          text.setAttribute(\"fill\", \"rgb(174, 174, 174)\");\r\n          text.setAttribute(\"font-size\", \"14px\");\r\n          text.setAttribute(\"text-anchor\", \"middle\");\r\n\r\n          this.container.appendChild(text);\r\n        }\r\n      }\r\n\r\n      //tooltip\r\n      if (this.options.tooltip.value) {\r\n        rect.addEventListener(\"mouseover\", (event) => {\r\n          tooltip.style.opacity = \"1\";\r\n          tooltip.textContent = this.options.tooltip.format(value);\r\n          const rectBox = rect.getBoundingClientRect();\r\n          const left =\r\n            rectBox.left + rectBox.width / 2 - tooltip.offsetWidth / 2;\r\n          tooltip.style.left = `${left}px`;\r\n          tooltip.style.top = `${rectBox.top - rectBox.height * 2}px`;\r\n        });\r\n\r\n        rect.addEventListener(\"mouseout\", () => {\r\n          tooltip.style.opacity = \"0\";\r\n        });\r\n      }\r\n    });\r\n  }\r\n}\r\nexport { Heatmap };\r\n"],"names":["Heatmap","container","data","options","defaultOptions","month","value","color","green","i","purple","blue","orange","tooltip","parentElement","scale","scaleY","rx","ry","index","rect","day","text","textX","textY","event","rectBox","left"],"mappings":"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"}