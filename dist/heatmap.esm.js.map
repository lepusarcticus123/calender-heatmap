{"version":3,"file":"heatmap.esm.js","sources":["../index.js"],"sourcesContent":["class Heatmap {\r\n  constructor(container, data, options) {\r\n    this.container = container;\r\n    this.data = data;\r\n    this.options = options;\r\n    const defaultOptions = {\r\n      x: 20,\r\n      y: 10,\r\n      color: \"green\",\r\n      cellSpacing: 2,\r\n      tipMonth: {\r\n        value: true,\r\n        format: (month) => month + \"月\", // 默认直接返回月份\r\n      },\r\n      tooltip: {\r\n        value: true,\r\n        format: (value) =>\r\n          `${value[1].toFixed(2)} 于 ${value[0].split()[0]}年 ${\r\n            value[0].split()[1]\r\n          }月 ${value[0].split()[2]}日`, // 默认显示值和日期\r\n      },\r\n    };\r\n    // 合并默认选项和用户传入的选项\r\n    this.options = { ...defaultOptions, ...options };\r\n  }\r\n  getColor(value, color) {\r\n    switch (color) {\r\n      case \"green\":\r\n        const green = [\r\n          { threshold: 0, color: \"#ebedf0\" }, // 最浅灰绿\r\n          { threshold: 1, color: \"#d4f5d0\" }, // 浅灰绿\r\n          { threshold: 10, color: \"#9be9a8\" }, // 浅绿色\r\n          { threshold: 15, color: \"#6dd785\" }, // 中浅绿色\r\n          { threshold: 20, color: \"#40c463\" }, // 中绿色\r\n          { threshold: 25, color: \"#30a14e\" }, // 深绿色\r\n          { threshold: 35, color: \"#216e39\" }, // 深灰绿色\r\n          { threshold: 50, color: \"#154823\" }, // 最深绿色\r\n        ];\r\n        for (let i = green.length - 1; i >= 0; i--) {\r\n          if (value >= green[i].threshold) return green[i].color;\r\n        }\r\n      case \"purple\":\r\n        const purple = [\r\n          { threshold: 0, color: \"#f5eef8\" }, // 最浅灰紫\r\n          { threshold: 1, color: \"#ebd7f1\" }, // 浅灰紫\r\n          { threshold: 10, color: \"#d7bde2\" }, // 浅紫色\r\n          { threshold: 15, color: \"#b887cd\" }, // 中浅紫\r\n          { threshold: 20, color: \"#a569bd\" }, // 中紫色\r\n          { threshold: 25, color: \"#8e44ad\" }, // 深紫色\r\n          { threshold: 35, color: \"#6b3582\" }, // 深灰紫\r\n          { threshold: 50, color: \"#5b2c6f\" }, // 最深紫色\r\n        ];\r\n        for (let i = purple.length - 1; i >= 0; i--) {\r\n          if (value >= purple[i].threshold) return purple[i].color;\r\n        }\r\n      case \"blue\":\r\n        const blue = [\r\n          { threshold: 0, color: \"#ebedf0\" }, // 最浅灰蓝\r\n          { threshold: 1, color: \"#d0e7f9\" }, // 浅灰蓝\r\n          { threshold: 10, color: \"#c6e0f5\" }, // 浅蓝色\r\n          { threshold: 15, color: \"#9bccf2\" }, // 中浅蓝\r\n          { threshold: 20, color: \"#73b3e7\" }, // 中蓝色\r\n          { threshold: 25, color: \"#3b82f6\" }, // 深蓝色\r\n          { threshold: 35, color: \"#215bb7\" }, // 深灰蓝\r\n          { threshold: 50, color: \"#174ea6\" }, // 最深蓝色\r\n        ];\r\n        for (let i = blue.length - 1; i >= 0; i--) {\r\n          if (value >= blue[i].threshold) return blue[i].color;\r\n        }\r\n      case \"orange\":\r\n        const orange = [\r\n          { threshold: 0, color: \"#fef5e7\" }, // 最浅灰橙\r\n          { threshold: 1, color: \"#fdebd0\" }, // 浅灰橙\r\n          { threshold: 10, color: \"#fdd0a6\" }, // 浅橙色\r\n          { threshold: 15, color: \"#f5b041\" }, // 中浅橙\r\n          { threshold: 20, color: \"#f39c12\" }, // 中橙色\r\n          { threshold: 25, color: \"#dc7633\" }, // 深橙色\r\n          { threshold: 35, color: \"#b24d00\" }, // 深灰橙\r\n          { threshold: 50, color: \"#a04000\" }, // 最深橙色\r\n        ];\r\n        for (let i = orange.length - 1; i >= 0; i--) {\r\n          if (value >= orange[i].threshold) return orange[i].color;\r\n        }\r\n      default:\r\n        return `rgb(${value * 255}, ${value * 255}, ${value * 255})`;\r\n    }\r\n  }\r\n\r\n  paint() {\r\n    const tooltip = document.createElement(\"div\"); // 创建一个 div 元素\r\n    tooltip.setAttribute(\"id\", \"tooltip\"); // 设置该 div 的 id 属性为 \"tooltip\"\r\n    const parentElement = this.container.parentElement;\r\n    tooltip.style.position = \"absolute\";\r\n    tooltip.style.backgroundColor = \"rgba(0, 0, 0, 0.9)\";\r\n    tooltip.style.color = \"white\";\r\n    tooltip.style.padding = \"6px\";\r\n    tooltip.style.borderRadius = \"5px\";\r\n    tooltip.style.opacity = \"0\";\r\n    tooltip.style.fontSize = \"smaller\";\r\n    tooltip.style.transition = \"opacity 0.5s\";\r\n    tooltip.style.pointerEvents = \"none\"; // 防止鼠标事件干扰\r\n    parentElement.appendChild(tooltip);\r\n\r\n    const scale = this.container.width.baseVal.value;\r\n    const scaleY = this.container.height.baseVal.value;\r\n    this.container.style.height = scaleY + 20;\r\n    const rx = scale * 0.01; // SVG 宽度的 2%\r\n    const ry = scaleY * 0.01; // SVG 高度的 2%\r\n\r\n    this.data.forEach((value, index) => {\r\n      let rect = document.createElementNS(\"http://www.w3.org/2000/svg\", \"rect\");\r\n      rect.setAttribute(\r\n        \"x\",\r\n        Math.floor(index / this.options.y) * (scale / this.options.x) // 列号\r\n      );\r\n      rect.setAttribute(\r\n        \"y\",\r\n        (index % this.options.y) * (scaleY / this.options.y) // 行号\r\n      );\r\n\r\n      rect.setAttribute(\r\n        \"width\",\r\n        scale / this.options.x - this.options.cellSpacing\r\n      );\r\n      rect.setAttribute(\r\n        \"height\",\r\n        scaleY / this.options.y - this.options.cellSpacing\r\n      );\r\n      rect.setAttribute(\"fill\", this.getColor(value[1], this.options.color));\r\n      rect.setAttribute(\"rx\", rx); // 设置圆角x轴半径\r\n      rect.setAttribute(\"ry\", ry); // 设置圆角y轴半径\r\n      this.container.appendChild(rect);\r\n      //月份提示\r\n      if (this.options.tipMonth.value) {\r\n        const day = value[0].split(\"-\")[2];\r\n        const month = value[0].split(\"-\")[1];\r\n        if (day == \"01\") {\r\n          const text = document.createElementNS(\r\n            \"http://www.w3.org/2000/svg\",\r\n            \"text\"\r\n          );\r\n          text.textContent = this.options.tipMonth.format(parseInt(month, 10)); // 格式化月份\r\n\r\n          const textX =\r\n            Math.floor(index / this.options.y) * (scale / this.options.x) + 10;\r\n          let textY = scaleY + 17; // 计算文本的 Y 坐标\r\n          text.setAttribute(\"x\", textX);\r\n          text.setAttribute(\"y\", textY); // 设置文本的 Y 坐标\r\n          text.setAttribute(\"fill\", \"rgb(174, 174, 174)\");\r\n          text.setAttribute(\"font-size\", \"14px\");\r\n          text.setAttribute(\"text-anchor\", \"middle\");\r\n\r\n          this.container.appendChild(text);\r\n        }\r\n      }\r\n\r\n      //tooltip\r\n      if (this.options.tooltip.value) {\r\n        rect.addEventListener(\"mouseover\", (event) => {\r\n          tooltip.style.opacity = \"1\";\r\n          tooltip.textContent = this.options.tooltip.format(value);\r\n          const rectBox = rect.getBoundingClientRect();\r\n          const left =\r\n            rectBox.left + rectBox.width / 2 - tooltip.offsetWidth / 2;\r\n          tooltip.style.left = `${left}px`;\r\n          tooltip.style.top = `${rectBox.top - rectBox.height * 2}px`;\r\n        });\r\n\r\n        rect.addEventListener(\"mouseout\", () => {\r\n          tooltip.style.opacity = \"0\";\r\n        });\r\n      }\r\n    });\r\n  }\r\n}\r\nexport { Heatmap };\r\n"],"names":["Heatmap","container","data","options","defaultOptions","month","value","color","green","i","purple","blue","orange","tooltip","parentElement","scale","scaleY","rx","ry","index","rect","day","text","textX","textY","event","rectBox","left"],"mappings":"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"}